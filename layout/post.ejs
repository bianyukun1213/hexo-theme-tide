<% const tideCtx=get_ctx(site,config,theme,page) %>

<!-- https%>/microformats.org/wiki/h-entry -->
<!-- <article class="h-entry">
  <h1 class="p-name">Microformats are amazing</h1>
  <p>Published by <a class="p-author h-card" href="http%>/example.com">W. Developer</a>
     on <time class="dt-published" datetime="2013-06-13 12:00:00">13<sup>th</sup> June 2013</time></p>
  
  <p class="p-summary">In which I extoll the virtues of using microformats.</p>
  
  <div class="e-content">
    <p>Blah blah blah</p>
  </div>
</article> -->

<!-- p-name - entry name/title
p-summary - short entry summary
e-content - full content of the entry


u-in-reply-to - the URL which the h-entry is considered reply to (i.e. doesn’t make sense without context, could show up in comment thread), optionally an embedded h-cite (reply-context) (example)

u-like-of - the URL which the h-entry is considered a “like” (favorite, star) of. Optionally an embedded h-cite
u-repost-of - the URL which the h-entry is considered a “repost” of. Optionally an embedded h-cite. -->
<article id="tide-post" <%- tideCtx.microformats2?' class="h-entry"':'' %>>
  <h1 id="tide-post-title" class="<%= tideCtx.microformats2?'p-name ':''%> un-mt-0 un-mb-2 un-text-4xl un-font-bold"><%= tideCtx.page_title?tideCtx.page_title:__('no_title') %></h1>
  <%- partial('./partials/post-meta.ejs',{postCtx:tideCtx,detailed:true}) %>
  <% if(tideCtx.microformats2){ %>
  <div class="tide-hidden-microformats2-group un-hidden">
    <a class="u-url un-hidden" href="<%= full_url_for(tideCtx.path) %>"><%= full_url_for(tideCtx.path) %></a>
    <% for(const card of tideCtx.page_h_cards){ %>
    <%- partial('./partials/h-card.ejs',{h_card:card,authorCard:true}) %>
    <% } %>
    <time class="dt-published un-hidden" datetime="<%= date_xml(tideCtx.date) %>"><%= date_xml(tideCtx.date) %></time>
    <time class="dt-updated un-hidden" datetime="<%= date_xml(tideCtx.updated) %>"><%= date_xml(tideCtx.updated) %></time>
    <% tideCtx.page_categories.forEach((cate,i)=>{ %>
    <a class="p-category un-hidden" href="<%= full_url_for(cate.path) %>"><%= cate.name %></a>
    <% }) %>
    <% tideCtx.syndications.forEach((syn,i)=>{ %>
    <a class="u-syndication un-hidden" href="<%= syn %>"><%= syn %></a>
    <% }) %>
    <% for(const interKey of Object.keys(tideCtx.indieweb_interactions)){ %>
    <% let interClass=''%>
    <!-- 如果把 switch 的每一行都包裹，会报错。通常来讲 EJS 不需要每一行都包裹；但是如果不这么做，语法高亮会变混乱。 -->
    <% switch(interKey){
      case 'reply':
      interClass='u-in-reply-to'
      break
      case 'like':
      interClass='u-like-of'
      break
      case 'repost':
      interClass='u-repost-of'
      break
      case 'bookmark':
      interClass='u-bookmark-of'
      break
      } %>
    <% if(interClass){ %>
    <% for(const interUrl of tideCtx.indieweb_interactions[interKey]){ %>
    <a class="<%= interClass %> un-hidden" href="<%= interUrl %>"><%= interUrl %></a>
    <% }}} %>
  </div>
  <% } %>




  <!-- post-meta test -->

  <!-- 应为 microformats2 单独提供 meta -->





  <!-- 应该是这种结构 -->
  <div class="un-prose un-max-w-none">
    <%-page.content%>
  </div>
</article>

<!--  -->

<div id="paginator">
  <%-paginator()%>
</div>