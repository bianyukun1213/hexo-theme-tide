/* preflights */

/* html {
    --tide-color-primary: #3F72AF;
    --tide-color-secondary: #00ADB5;
    --tide-color-background-primary: #FFFFFF;
    --tide-color-background-secondary: #FAFAFA;
    --tide-color-text-primary: #323739;
    --tide-color-text-secondary: #5c6669;
    --tide-color-text-diminished: #EAECED;
    --tide-color-text-side-bar: #FFFFFF;
    --tide-color-focused-outline: #E36209;
    --tide-color-link: #3F72AF;
    --tide-color-link-hover: #3F72AF;
    --tide-color-link-visited: #00ADB5;
    --tide-color-code: #3F72AF;
    --tide-color-table-border: #E5E7EB;
    --tide-color-table-background-head: #F3F3F3;
    --tide-color-table-background-even: #FAFAFA;
} */

@media (prefers-color-scheme: no-preference) {
    html {
        --tide-background-image-side-bar: <TIDE_BACKGROUND_IMAGE_SIDE_BAR_LIGHT>;
        --tide-color-primary: <TIDE_COLOR_PRIMARY_LIGHT>;
        --tide-color-secondary: <TIDE_COLOR_SECONDARY_LIGHT>;
        --tide-color-background-primary: <TIDE_COLOR_BACKGROUND_PRIMARY_LIGHT>;
        --tide-color-background-secondary: <TIDE_COLOR_BACKGROUND_SECONDARY_LIGHT>;
        --tide-color-text-primary: <TIDE_COLOR_TEXT_PRIMARY_LIGHT>;
        --tide-color-text-secondary: <TIDE_COLOR_TEXT_SECONDARY_LIGHT>;
        --tide-color-text-diminished: <TIDE_COLOR_TEXT_DIMINISHED_LIGHT>;
        --tide-color-text-side-bar: <TIDE_COLOR_TEXT_SIDE_BAR_LIGHT>;
        --tide-color-focused-outline: <TIDE_COLOR_FOCUSED_OUTLINE_LIGHT>;
        --tide-color-link: <TIDE_COLOR_LINK_LIGHT>;
        --tide-color-link-hover: <TIDE_COLOR_LINK_HOVER_LIGHT>;
        --tide-color-link-visited: <TIDE_COLOR_LINK_VISITED_LIGHT>;
        --tide-color-code-inline: <TIDE_COLOR_CODE_INLINE_LIGHT>;
        --tide-color-table-border: <TIDE_COLOR_TABLE_BORDER_LIGHT>;
        --tide-color-table-background-head: <TIDE_COLOR_TABLE_BACKGROUND_HEAD_LIGHT>;
        --tide-color-table-background-even: <TIDE_COLOR_TABLE_BACKGROUND_EVEN_LIGHT>;
    }
}

@media (prefers-color-scheme: light) {
    html {
        --tide-background-image-side-bar: <TIDE_BACKGROUND_IMAGE_SIDE_BAR_LIGHT>;
        --tide-color-primary: <TIDE_COLOR_PRIMARY_LIGHT>;
        --tide-color-secondary: <TIDE_COLOR_SECONDARY_LIGHT>;
        --tide-color-background-primary: <TIDE_COLOR_BACKGROUND_PRIMARY_LIGHT>;
        --tide-color-background-secondary: <TIDE_COLOR_BACKGROUND_SECONDARY_LIGHT>;
        --tide-color-text-primary: <TIDE_COLOR_TEXT_PRIMARY_LIGHT>;
        --tide-color-text-secondary: <TIDE_COLOR_TEXT_SECONDARY_LIGHT>;
        --tide-color-text-diminished: <TIDE_COLOR_TEXT_DIMINISHED_LIGHT>;
        --tide-color-text-side-bar: <TIDE_COLOR_TEXT_SIDE_BAR_LIGHT>;
        --tide-color-focused-outline: <TIDE_COLOR_FOCUSED_OUTLINE_LIGHT>;
        --tide-color-link: <TIDE_COLOR_LINK_LIGHT>;
        --tide-color-link-hover: <TIDE_COLOR_LINK_HOVER_LIGHT>;
        --tide-color-link-visited: <TIDE_COLOR_LINK_VISITED_LIGHT>;
        --tide-color-code-inline: <TIDE_COLOR_CODE_INLINE_LIGHT>;
        --tide-color-table-border: <TIDE_COLOR_TABLE_BORDER_LIGHT>;
        --tide-color-table-background-head: <TIDE_COLOR_TABLE_BACKGROUND_HEAD_LIGHT>;
        --tide-color-table-background-even: <TIDE_COLOR_TABLE_BACKGROUND_EVEN_LIGHT>;
    }
}

@media (prefers-color-scheme: dark) {
    html {
        --tide-background-image-side-bar: <TIDE_BACKGROUND_IMAGE_SIDE_BAR_DARK>;
        --tide-color-primary: <TIDE_COLOR_PRIMARY_DARK>;
        --tide-color-secondary: <TIDE_COLOR_SECONDARY_DARK>;
        --tide-color-background-primary: <TIDE_COLOR_BACKGROUND_PRIMARY_DARK>;
        --tide-color-background-secondary: <TIDE_COLOR_BACKGROUND_SECONDARY_DARK>;
        --tide-color-text-primary: <TIDE_COLOR_TEXT_PRIMARY_DARK>;
        --tide-color-text-secondary: <TIDE_COLOR_TEXT_SECONDARY_DARK>;
        --tide-color-text-diminished: <TIDE_COLOR_TEXT_DIMINISHED_DARK>;
        --tide-color-text-side-bar: <TIDE_COLOR_TEXT_SIDE_BAR_DARK>;
        --tide-color-focused-outline: <TIDE_COLOR_FOCUSED_OUTLINE_DARK>;
        --tide-color-link: <TIDE_COLOR_LINK_DARK>;
        --tide-color-link-hover: <TIDE_COLOR_LINK_HOVER_DARK>;
        --tide-color-link-visited: <TIDE_COLOR_LINK_VISITED_DARK>;
        --tide-color-code-inline: <TIDE_COLOR_CODE_INLINE_DARK>;
        --tide-color-table-border: <TIDE_COLOR_TABLE_BORDER_DARK>;
        --tide-color-table-background-head: <TIDE_COLOR_TABLE_BACKGROUND_HEAD_DARK>;
        --tide-color-table-background-even: <TIDE_COLOR_TABLE_BACKGROUND_EVEN_DARK>;
    }
}

html[tide-light] {
    --tide-background-image-side-bar: <TIDE_BACKGROUND_IMAGE_SIDE_BAR_LIGHT>;
    --tide-color-primary: <TIDE_COLOR_PRIMARY_LIGHT>;
    --tide-color-secondary: <TIDE_COLOR_SECONDARY_LIGHT>;
    --tide-color-background-primary: <TIDE_COLOR_BACKGROUND_PRIMARY_LIGHT>;
    --tide-color-background-secondary: <TIDE_COLOR_BACKGROUND_SECONDARY_LIGHT>;
    --tide-color-text-primary: <TIDE_COLOR_TEXT_PRIMARY_LIGHT>;
    --tide-color-text-secondary: <TIDE_COLOR_TEXT_SECONDARY_LIGHT>;
    --tide-color-text-diminished: <TIDE_COLOR_TEXT_DIMINISHED_LIGHT>;
    --tide-color-text-side-bar: <TIDE_COLOR_TEXT_SIDE_BAR_LIGHT>;
    --tide-color-focused-outline: <TIDE_COLOR_FOCUSED_OUTLINE_LIGHT>;
    --tide-color-link: <TIDE_COLOR_LINK_LIGHT>;
    --tide-color-link-hover: <TIDE_COLOR_LINK_HOVER_LIGHT>;
    --tide-color-link-visited: <TIDE_COLOR_LINK_VISITED_LIGHT>;
    --tide-color-code-inline: <TIDE_COLOR_CODE_INLINE_DARK>;
    --tide-color-table-border: <TIDE_COLOR_TABLE_BORDER_LIGHT>;
    --tide-color-table-background-head: <TIDE_COLOR_TABLE_BACKGROUND_HEAD_LIGHT>;
    --tide-color-table-background-even: <TIDE_COLOR_TABLE_BACKGROUND_EVEN_LIGHT>;
}

html[tide-dark] {
    --tide-background-image-side-bar: <TIDE_BACKGROUND_IMAGE_SIDE_BAR_DARK>;
    --tide-color-primary: <TIDE_COLOR_PRIMARY_DARK>;
    --tide-color-secondary: <TIDE_COLOR_SECONDARY_DARK>;
    --tide-color-background-primary: <TIDE_COLOR_BACKGROUND_PRIMARY_DARK>;
    --tide-color-background-secondary: <TIDE_COLOR_BACKGROUND_SECONDARY_DARK>;
    --tide-color-text-primary: <TIDE_COLOR_TEXT_PRIMARY_DARK>;
    --tide-color-text-secondary: <TIDE_COLOR_TEXT_SECONDARY_DARK>;
    --tide-color-text-diminished: <TIDE_COLOR_TEXT_DIMINISHED_DARK>;
    --tide-color-text-side-bar: <TIDE_COLOR_TEXT_SIDE_BAR_DARK>;
    --tide-color-focused-outline: <TIDE_COLOR_FOCUSED_OUTLINE_DARK>;
    --tide-color-link: <TIDE_COLOR_LINK_DARK>;
    --tide-color-link-hover: <TIDE_COLOR_LINK_HOVER_DARK>;
    --tide-color-link-visited: <TIDE_COLOR_LINK_VISITED_DARK>;
    --tide-color-code: <TIDE_COLOR_CODE_DARK>;
    --tide-color-table-border: <TIDE_COLOR_TABLE_BORDER_DARK>;
    --tide-color-table-background-head: <TIDE_COLOR_TABLE_BACKGROUND_HEAD_DARK>;
    --tide-color-table-background-even: <TIDE_COLOR_TABLE_BACKGROUND_EVEN_DARK>;
}

html {
    /* 要与 unocss（tailwind 4.0？）主题配置同步 */
    --tide-unocss-spacing: 0.25rem;
    --tide-font-global: <TIDE_FONT_GLOBAL>;
    --tide-font-site-title: <TIDE_FONT_SITE_TITLE>;
    --tide-font-site-subtitle: <TIDE_FONT_SITE_SUBTITLE>;
    --tide-font-prose: <TIDE_FONT_PROSE>;
    /* --tide-font-code: <TIDE_FONT_CODE>; */
    /* --tide-font-global: 'Noto Serif SC', serif; */
}

* {
    scrollbar-width: thin;
}

a {
    @apply sc-link-default;
}

button {
    -webkit-tap-highlight-color: transparent;
}

.tide-table-wrapper {
    @apply overflow-auto;
    /* unocss prose 的 table 默认有 1em 0px 的 margin，转移到 wrapper 上。 */
    margin: 1em 0;
}

#tide-root {
    font-family: var(--tide-font-global);
}

#tide-site-title {
    font-family: var(--tide-font-site-title);
}

#tide-site-subtitle {
    font-family: var(--tide-font-site-subtitle);
}

[un-prose] {
    font-family: var(--tide-font-prose) !important;
}

/* [un-prose] code:not(.not-prose) {
    font-family: var(--tide-font-code) !important; 由 prism.js 指定，否则可能出现行号对不上的问题。
} */

#tide-side-bar {
    background-image: var(--tide-background-image-side-bar);
}

[tabindex]:not([tabindex="-1"]):focus,
a:focus,
button:focus,
input:focus,
select:focus:focus,
textarea:focus {
    @apply outline-2 outline-offset-4 !outline-fcs-ol outline-solid;
}

@unocss;

/* 自定义样式 */

[tide-side-bar-expanded="true"] #tide-btn-nav-icon-bars {
    @apply hidden;
}

[tide-side-bar-expanded="true"] #tide-btn-nav-icon-close {
    @apply inline;
}

[tide-side-bar-expanded="false"] #tide-btn-nav-icon-bars {
    @apply inline;
}

[tide-side-bar-expanded="false"] #tide-btn-nav-icon-close {
    @apply hidden;
}

/* 默认小屏幕 */
/* 侧栏默认整体滚动 */
#tide-side-bar {
    width: min(var(--tide-unocss-spacing) * 96, 75vw);
    @apply overflow-auto;
}

[dir="ltr"] #tide-side-bar {
    left: max(var(--tide-unocss-spacing) * -96, -75vw);
}

/* 使用 [dir="ltr"] 而非 @apply ltr:…… ，因为后者在转换后会有空的样式，显示警告 */
[dir="ltr"] [tide-side-bar-expanded="true"] #tide-side-bar,
[dir="ltr"] [tide-side-bar-expanded="true"] #tide-content {
    transform: translateX(min(var(--tide-unocss-spacing) * 96, 75vw));
}

[dir="rtl"] #tide-side-bar {
    right: max(var(--tide-unocss-spacing) * -96, -75vw);
}

[dir="rtl"] [tide-side-bar-expanded="true"] #tide-side-bar,
[dir="rtl"] [tide-side-bar-expanded="true"] #tide-content {
    transform: translateX(max(var(--tide-unocss-spacing) * -96, -75vw));
}

#tide-site-title {
    @apply text-3xl;
}

#tide-navigation ul {
    @apply text-xl;
}

#tide-main-content {
    @apply px-4;
    @apply py-8;
}

.tide-image-figure {
    @apply max-w-4/5;
    @apply mx-auto;
}

/* md 往后调整侧边栏宽度为 96 */
@media (min-width: 768px) {
    #tide-site-title {
        @apply text-4xl;
    }

    #tide-navigation ul {
        @apply text-2xl;
    }

    #tide-main-content {
        @apply px-16;
    }
}

@media (min-width: 1280px) {
    .tide-image-figure {
        @apply max-w-1/2;
    }
}

/* xl 往后非文章页横向不再允许折叠 */
@media (orientation: landscape) {


    @media (min-width: 1280px) {

        /* 1280*768 后侧栏整体不再允许滚动，导航部分允许滚动 */
        @media (min-height: 768px) {
            #tide-side-bar {
                @apply overflow-clip;
            }

            #tide-navigation {
                @apply overflow-auto;
            }
        }

        [dir="ltr"] :not([tide-is-post]) #tide-side-bar,
        [dir="ltr"] :not([tide-is-post]) #tide-content {
            transform: translateX(min(var(--tide-unocss-spacing) * 96, 75vw));
        }

        [dir="rtl"] :not([tide-is-post]) #tide-side-bar,
        [dir="rtl"] :not([tide-is-post]) #tide-content {
            transform: translateX(max(var(--tide-unocss-spacing) * -96, -75vw));
        }

        #tide-deco #triangle-big {
            @apply fill-prim;
        }

        :not([tide-is-post]) #tide-content {
            width: calc(100% - min(var(--tide-unocss-spacing) * 96, 75vw));
        }

        :not([tide-is-post]) #tide-btn-nav {
            @apply hidden;
        }

        .tide-image-figure {
            @apply max-w-1/2;
        }
    }
}

.tide-paginator span {
    @apply inline-block;
    @apply mx-1;
    @apply underline;
    @apply underline-offset-4;
}

.tide-paginator a {
    @apply inline-block;
    @apply mx-1;
    @apply sc-link-plain;
    @apply !text-t-scnd;
}

/* high contrust optimization */

#tide-side-bar,
.tide-dialog-container,
.tide-dialog-container button,
iframe,
pre:has(code),
.gist {
    @apply outline-2 outline-transparent outline-solid;
}

@media (forced-colors: active) {
    .tide-dialog-mask {
        @apply bg-black;
    }
}